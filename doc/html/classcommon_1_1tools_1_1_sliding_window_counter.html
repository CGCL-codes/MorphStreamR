<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MorphStream: common.tools.SlidingWindowCounter&lt; T &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MorphStream
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>common</b></li><li class="navelem"><b>tools</b></li><li class="navelem"><a class="el" href="classcommon_1_1tools_1_1_sliding_window_counter.html">SlidingWindowCounter</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classcommon_1_1tools_1_1_sliding_window_counter-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">common.tools.SlidingWindowCounter&lt; T &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This class counts objects in a sliding window fashion.  
 <a href="classcommon_1_1tools_1_1_sliding_window_counter.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for common.tools.SlidingWindowCounter&lt; T &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classcommon_1_1tools_1_1_sliding_window_counter__inherit__graph.png" border="0" usemap="#common_8tools_8_sliding_window_counter_3_01_t_01_4_inherit__map" alt="Inheritance graph"/></div>
<map name="common_8tools_8_sliding_window_counter_3_01_t_01_4_inherit__map" id="common_8tools_8_sliding_window_counter_3_01_t_01_4_inherit__map">
<area shape="rect" title="This class counts objects in a sliding window fashion." alt="" coords="5,80,220,121"/>
<area shape="rect" title=" " alt="" coords="63,5,162,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for common.tools.SlidingWindowCounter&lt; T &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classcommon_1_1tools_1_1_sliding_window_counter__coll__graph.png" border="0" usemap="#common_8tools_8_sliding_window_counter_3_01_t_01_4_coll__map" alt="Collaboration graph"/></div>
<map name="common_8tools_8_sliding_window_counter_3_01_t_01_4_coll__map" id="common_8tools_8_sliding_window_counter_3_01_t_01_4_coll__map">
<area shape="rect" title="This class counts objects in a sliding window fashion." alt="" coords="5,80,220,121"/>
<area shape="rect" title=" " alt="" coords="63,5,162,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa7fc0df180b708834746e35e74d1152b"><td class="memItemLeft" align="right" valign="top"><a id="aa7fc0df180b708834746e35e74d1152b"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>SlidingWindowCounter</b> (int windowLengthInSlots)</td></tr>
<tr class="separator:aa7fc0df180b708834746e35e74d1152b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a0eb16b05f00845eef8a703c6aa54bd"><td class="memItemLeft" align="right" valign="top"><a id="a8a0eb16b05f00845eef8a703c6aa54bd"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>incrementCount</b> (T obj)</td></tr>
<tr class="separator:a8a0eb16b05f00845eef8a703c6aa54bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99b341a2a03aac4d072ff44b96386b8b"><td class="memItemLeft" align="right" valign="top"><a id="a99b341a2a03aac4d072ff44b96386b8b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>incrementCount</b> (T obj, long increment)</td></tr>
<tr class="separator:a99b341a2a03aac4d072ff44b96386b8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ff467d85e35abc3c4e72ee631e8fd0b"><td class="memItemLeft" align="right" valign="top"><a id="a1ff467d85e35abc3c4e72ee631e8fd0b"></a>
long&#160;</td><td class="memItemRight" valign="bottom"><b>getCount</b> (T obj)</td></tr>
<tr class="separator:a1ff467d85e35abc3c4e72ee631e8fd0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a102f9bcb5167bf9053361adcf53524ea"><td class="memItemLeft" align="right" valign="top"><a id="a102f9bcb5167bf9053361adcf53524ea"></a>
Map&lt; T, Long &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>getCounts</b> ()</td></tr>
<tr class="separator:a102f9bcb5167bf9053361adcf53524ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab67babcd91767ee68de51c7bddaa4976"><td class="memItemLeft" align="right" valign="top">Map&lt; T, Long &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcommon_1_1tools_1_1_sliding_window_counter.html#ab67babcd91767ee68de51c7bddaa4976">getCountsThenAdvanceWindow</a> ()</td></tr>
<tr class="memdesc:ab67babcd91767ee68de51c7bddaa4976"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the current (total) counts of all tracked objects, then advance the window.  <a href="classcommon_1_1tools_1_1_sliding_window_counter.html#ab67babcd91767ee68de51c7bddaa4976">More...</a><br /></td></tr>
<tr class="separator:ab67babcd91767ee68de51c7bddaa4976"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class counts objects in a sliding window fashion. </p>
<p>It is designed 1) to give multiple "producer" threads write access to the counter, i.e. being able to increment counts of objects, and 2) to give a partition "consumer" thread (e.g. <a class="el" href="">PeriodicSlidingWindowCounter</a>) read access to the counter. Whenever the consumer thread performs a read operation, this class will advance the head slot of the sliding window counter. This means that the consumer thread indirectly controls where writes of the producer threads will go to. Also, by itself this class will not advance the head slot. </p>
<p>A note for analyzing data based on a sliding window count: During the initial <code>windowLengthInSlots</code> iterations, this sliding window counter will always return object counts that are equal or greater than in the previous iteration. This is the effect of the counter "loading up" at the very start of its existence. Conceptually, this is the desired behavior. </p>
<p>To give an streaming, using a counter with 5 slots which for the sake of this streaming represent 1 minute of time each: </p>
<pre>
<div class="fragment"><div class="line">Sliding window counts of an <span class="keywordtype">object</span> X over time</div>
<div class="line"> </div>
<div class="line">Minute (timeline):</div>
<div class="line">1    2   3   4   5   6   7   8</div>
<div class="line"> </div>
<div class="line">Observed counts per minute:</div>
<div class="line">1    1   1   1   0   0   0   0</div>
<div class="line"> </div>
<div class="line">Counts returned by counter:</div>
<div class="line">1    2   3   4   4   3   2   1</div>
</div><!-- fragment --> 
</pre> <p>As you can see in this streaming, for the first <code>windowLengthInSlots</code> (here: the first five minutes) the counter will always return counts equal or greater than in the previous iteration (1, 2, 3, 4, 4). This initial load effect needs to be accounted for whenever you want to perform analyses such as trending topics; otherwise your analysis algorithm might falsely identify the object to be trending as the counter seems to observe continuously increasing counts. Also, note that during the initial load phase <em>every object</em> will exhibit increasing counts. </p>
<p>On a high-level, the counter exhibits the following behavior: If you asked the streaming counter after two minutes, "how often did you count the object during the past five minutes?", then it should reply "I have counted it 2 times
in the past five minutes", implying that it can only account for the last two of those five minutes because the counter was not running before that time.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">&lt;T&gt;</td><td>The type of those objects we want to count. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_sliding_window_counter_8java_source.html#l00051">51</a> of file <a class="el" href="_sliding_window_counter_8java_source.html">SlidingWindowCounter.java</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="ab67babcd91767ee68de51c7bddaa4976"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab67babcd91767ee68de51c7bddaa4976">&#9670;&nbsp;</a></span>getCountsThenAdvanceWindow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Map&lt;T, Long&gt; <a class="el" href="classcommon_1_1tools_1_1_sliding_window_counter.html">common.tools.SlidingWindowCounter</a>&lt; T &gt;.getCountsThenAdvanceWindow </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the current (total) counts of all tracked objects, then advance the window. </p>
<p>Whenever this method is called, we consider the counts of the current sliding window to be available to and successfully processed "upstream" (i.e. by the caller). Knowing this we will start counting any subsequent objects within the next "chunk" of the sliding window.</p>
<dl class="section return"><dt>Returns</dt><dd>The current (total) counts of all tracked objects. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_sliding_window_counter_8java_source.html#l00096">96</a> of file <a class="el" href="_sliding_window_counter_8java_source.html">SlidingWindowCounter.java</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcommon_1_1tools_1_1_sliding_window_counter_ab67babcd91767ee68de51c7bddaa4976_cgraph.png" border="0" usemap="#classcommon_1_1tools_1_1_sliding_window_counter_ab67babcd91767ee68de51c7bddaa4976_cgraph" alt=""/></div>
<map name="classcommon_1_1tools_1_1_sliding_window_counter_ab67babcd91767ee68de51c7bddaa4976_cgraph" id="classcommon_1_1tools_1_1_sliding_window_counter_ab67babcd91767ee68de51c7bddaa4976_cgraph">
<area shape="rect" title="Return the current (total) counts of all tracked objects, then advance the window." alt="" coords="5,27,288,69"/>
<area shape="rect" href="classcommon_1_1tools_1_1_slot_based_counter.html#a35dceb743b2007016e451d6e9c0126c1" title="Reset the slot count of any tracked objects to zero for the given slot." alt="" coords="336,5,631,32"/>
<area shape="rect" href="classcommon_1_1tools_1_1_slot_based_counter.html#ac6af438a4e965cb7848b5f39a9666903" title="Remove any object from the counter whose total count is zero (to free up memory)." alt="" coords="349,57,618,98"/>
</map>
</div>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>common/src/main/java/common/tools/<a class="el" href="_sliding_window_counter_8java_source.html">SlidingWindowCounter.java</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
